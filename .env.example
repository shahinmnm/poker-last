# =============================================================================
# POKER BOT - MAIN ENVIRONMENT CONFIGURATION
# =============================================================================
# This is the PRIMARY and ONLY REQUIRED .env file for the entire application.
# All Docker services (bot, api, frontend, postgres, redis) read from this file.
#
# For detailed documentation on .env file structure, see: ENV_FILES.md
#
# Quick Start:
#   1. Copy this file: cp .env.example .env
#   2. Update the values below (especially secrets and tokens)
#   3. Deploy: ./deploy/first-deploy.sh --with-nginx
#
# =============================================================================
# COMPOSE & DEPLOYMENT
# =============================================================================
COMPOSE_PROJECT_NAME=pokerbot

# =============================================================================
# DATABASE
# =============================================================================
# The default database user is "pokerbot" (NOT "postgres")
# All internal services use these credentials via environment variables
POSTGRES_DB=pokerbot
POSTGRES_USER=pokerbot
POSTGRES_PASSWORD=changeme
POSTGRES_PORT=5432
# DATABASE_URL is automatically constructed from POSTGRES_* variables above.
# Only uncomment to override with a custom connection string:
# DATABASE_URL=postgresql+asyncpg://pokerbot:changeme@postgres:5432/pokerbot

# =============================================================================
# REDIS
# =============================================================================
REDIS_PORT=6379
REDIS_DB=0
REDIS_URL=redis://redis:6379/0

# =============================================================================
# TELEGRAM BOT
# =============================================================================
TELEGRAM_BOT_TOKEN=your_bot_token_here
TELEGRAM_WEBHOOK_SECRET_TOKEN=your_webhook_secret
ADMIN_CHAT_ID=your_admin_chat_id

# =============================================================================
# WEBHOOK & API
# =============================================================================
PUBLIC_BASE_URL=https://your-domain.com
WEBHOOK_PATH=/telegram/webhook
WEBHOOK_SECRET_TOKEN=your_webhook_secret
WEBHOOK_BIND_HOST=0.0.0.0
WEBHOOK_BIND_PORT=8443
WEBAPP_SECRET=your_webapp_secret_here
CORS_ORIGINS=https://your-domain.com

# =============================================================================
# AUTH / SECURITY
# =============================================================================
# Strong random secret for signing JWTs (required)
JWT_SECRET_KEY=CHANGE_ME_IN_PRODUCTION

# Admin Panel Security
# Secret key for bot-to-API communication (generate a random 32+ char string)
INTERNAL_API_KEY=your_internal_api_key_here
# One-time admin entry token TTL in seconds (default: 120 = 2 minutes)
ADMIN_ENTRY_TOKEN_TTL_SECONDS=120
# Admin session TTL in seconds (default: 28800 = 8 hours)
ADMIN_SESSION_TTL_SECONDS=28800
# Public URL where /admin/enter is served (must be routed to backend by nginx)
# Usually same as PUBLIC_BASE_URL. Only set if admin entry needs different domain.
# ADMIN_PUBLIC_BASE_URL=https://your-domain.com
# Path to admin dashboard (frontend route after authentication)
# ADMIN_DASHBOARD_PATH=/admin/panel

# Internal API URL for bot-to-API communication within Docker network
# This is automatically set in docker-compose.yml - only override if needed
# For Docker: http://api:8000/api (uses service name resolution)
# For local dev: http://localhost:8000/api
# API_BASE_URL=http://api:8000/api

# =============================================================================
# LOGGING & TRACING
# =============================================================================
LOG_LEVEL=INFO
LOG_JSON=false
TRACE_UPDATES=false
TRACE_SQL=false
TRACE_ENGINE=false

# =============================================================================
# GAME CONFIGURATION
# =============================================================================
FEATURE_WALLET=false
MATCHMAKING_POOL_TTL=120
PRIVATE_GAME_TTL=3600
DEFAULT_STARTING_STACK=10000
SMALL_BLIND=25
BIG_BLIND=50

# Wallet Configuration (USD-based, stored as cents)
# Initial balance given to new users (in USD)
INITIAL_BALANCE_USD=100.00

# =============================================================================
# FRONTEND BUILD
# =============================================================================
# API base URL for frontend requests
# For production behind Nginx (routes /api/* to backend): use /api
# For local development (Vite + backend on localhost): use http://localhost:8000
VITE_API_URL=/api
VITE_BOT_USERNAME=@your_bot_username

# =============================================================================
# SERVICE PORTS
# =============================================================================
API_PORT=8000
FRONTEND_PORT=3000
NGINX_HTTP_PORT=80
NGINX_HTTPS_PORT=443

# =============================================================================
# SSL/TLS CONFIGURATION
# =============================================================================
# Path to SSL certificates (used by Nginx)
# For Let's Encrypt: ./deploy/nginx/ssl
# For custom certificates: point to your certificate directory
NGINX_SSL_CERT_PATH=./deploy/nginx/ssl

# Domain name for SSL certificate (used by certbot)
DOMAIN_NAME=your-domain.com

# Email for Let's Encrypt certificate notifications
CERTBOT_EMAIL=admin@your-domain.com

# =============================================================================
# PRODUCTION SETTINGS
# =============================================================================
# Number of Uvicorn workers for backend API
UVICORN_WORKERS=2

# Post-hand delay in seconds (time between hands for showdown display)
# Default: 20. Telegram UX works best with 15-30 seconds.
# Too low (<10s) may cause greenlet_spawn errors during rapid hand transitions.
POST_HAND_DELAY_SECONDS=15

# Table inactivity timeout (minutes)
TABLE_ALL_SITOUT_TIMEOUT_MINUTES=5

# Mini app URL (for redirects)
MINI_APP_URL=https://your-domain.com

# =============================================================================
# BACKUP CONFIGURATION
# =============================================================================
# Directory for backups (default: ./backups)
BACKUP_DIR=./backups

# Number of backups to keep (default: 10)
BACKUP_RETENTION=10

# Log size threshold for cleanup (e.g., 100M, 1G)
LOG_SIZE_THRESHOLD=100M

# =============================================================================
# GIT AUTOMATION (USED BY DEPLOYMENT SCRIPTS)
# =============================================================================
DEPLOY_GIT_REMOTE=origin
DEPLOY_GIT_BRANCH=gamecore
